# Edulume API Documentation

This document describes the Edulume HTTP API. Each endpoint entry follows the same structure:

- Method and full path
- Authentication required
- Request body parameters (if any)
- Response format
- Short example

Group base paths documented below:

- /api/auth/*
- /api/courses/*
- /api/roadmaps/*
- /api/discussions/*
- /api/pdfs/*
- /api/ebooks/*

---

## Authentication (/api/auth)

POST /api/auth/send-otp
- Authentication: No
- Request body:
	```json
	{ "email": "string", "type": "signup|reset" }
	```
- Response (200):
	```json
	{ "message": "OTP sent successfully" }
	```
- Example: send OTP for signup.

POST /api/auth/verify-otp
- Authentication: No
- Request body:
	```json
	{ "email": "string", "otp": "string", "type": "signup|reset" }
	```
- Response (200):
	```json
	{ "verified": true, "message": "OTP verified successfully" }
	```

POST /api/auth/signup
- Authentication: No
- Request body:
	```json
	{ "username": "string", "email": "string", "password": "string", "otp": "string (if required)" }
	```
- Response (201):
	```json
	{ "token": "jwt", "user": { "id": "string", "username": "string", "email": "string" } }
	```

POST /api/auth/login
- Authentication: No
- Request body:
	```json
	{ "usernameOrEmail": "string", "password": "string" }
	```
- Response (200):
	```json
	{ "token": "jwt", "user": { "id": "string", "username": "string", "email": "string" } }
	```

POST /api/auth/forgot-password
- Authentication: No
- Request body:
	```json
	{ "email": "string" }
	```
- Response (200):
	```json
	{ "message": "Password reset code sent to your email" }
	```

POST /api/auth/reset-password
- Authentication: No
- Request body:
	```json
	{ "email": "string", "otp": "string", "newPassword": "string" }
	```
- Response (200):
	```json
	{ "message": "Password reset successfully" }
	```

POST /api/auth/logout
- Authentication: No
- Request body: none
- Response (200):
	```json
	{ "message": "Logged out successfully" }
	```

GET /api/auth/profile
- Authentication: Yes (Bearer token)
- Request: Authorization header `Bearer <token>`
- Response (200):
	```json
	{ "user": { "id": "string", "username": "string", "email": "string", "created_at": "ISO8601", "is_admin": false } }
	```

POST /api/auth/set-username
- Authentication: Yes (Bearer token)
- Request body:
	```json
	{ "username": "string" }
	```
- Response (200):
	```json
	{ "token": "jwt", "user": { "id": "string", "username": "string", "email": "string" } }
	```

POST /api/auth/change-username
- Authentication: Yes (Bearer token)
- Request body:
	```json
	{ "username": "string" }
	```
- Response (200):
	```json
	{ "token": "jwt", "user": { "id": "string", "username": "string", "email": "string" } }
	```

GET /api/auth/google
- Authentication: No
- Description: Initiates Google OAuth flow (redirect)

GET /api/auth/google/callback
- Authentication: No
- Description: OAuth callback that redirects to client with token on success

GET /api/auth/debug/admin-emails
- Authentication: No
- Response (200): list of admin emails (debug endpoint)

---

## Courses (/api/courses)

GET /api/courses/
- Authentication: Optional (Bearer token)
- Query parameters:
	- `search` (string)
	- `filter` (string) one of `all|my-courses|bookmarked|enrolled` (default `all`)
	- `sort` (string) e.g. `recent|popular|oldest`
	- `page` (number)
	- `limit` (number)
- Response (200):
	```json
	{ "courses": [ /* course objects */ ], "pagination": { "page": 1, "limit": 12, "total": 0, "pages": 0 } }
	```

GET /api/courses/:id
- Authentication: Optional
- Response (200):
	```json
	{ "course": { /* detailed course with chapters, author, enrollment/bookmark flags */ } }
	```

POST /api/courses/generate-outline
- Authentication: Yes
- Request body:
	```json
	{ "topic": "string" }
	```
- Response (200): JSON outline object generated by AI

POST /api/courses/
- Authentication: Yes
- Request body:
	```json
	{ "title": "string", "description": "string", "topic": "string", "chapters": [ { "title": "string", "description": "string", "order_index": 1 } ], "isPublic": true }
	```
- Response (201):
	```json
	{ "id": "string", "message": "Course created successfully", "course": { /* course */ } }
	```

POST /api/courses/:courseId/chapters/:chapterId/generate-content
- Authentication: Yes
- Request body: none
- Response (200):
	```json
	{ "message": "Chapter content generated successfully", "content": "string", "chapter": { /* chapter */ } }
	```

POST /api/courses/:id/bookmark
- Authentication: Yes
- Request body: none
- Response (200): toggles bookmark status
	```json
	{ "message": "Course bookmarked", "bookmarked": true }
	```

PUT /api/courses/:id
- Authentication: Yes
- Request body (any of):
	```json
	{ "title": "string", "description": "string", "topic": "string", "isPublic": true }
	```
- Response (200):
	```json
	{ "message": "Course updated successfully", "course": { /* updated */ } }
	```

DELETE /api/courses/:id
- Authentication: Yes
- Response (200):
	```json
	{ "message": "Course deleted successfully" }
	```

POST /api/courses/:id/enroll
- Authentication: Yes
- Request body: none
- Response (200):
	```json
	{ "message": "Successfully enrolled in course", "enrollment": { "id": "string", "enrolledAt": "ISO8601", "isCompleted": false } }
	```

DELETE /api/courses/:id/enroll
- Authentication: Yes
- Response (200):
	```json
	{ "message": "Successfully unenrolled from course" }
	```

POST /api/courses/:courseId/chapters/:chapterId/progress
- Authentication: Yes
- Request body:
	```json
	{ "isCompleted": true }
	```
- Response (200): progress summary
	```json
	{ "message": "Progress updated successfully", "progress": { "isCompleted": true, "completedAt": "ISO8601", "progressPercentage": 50 } }
	```

GET /api/courses/user/enrollments
- Authentication: Yes
- Query: `page`, `limit`
- Response (200): list of user enrollments with pagination

GET /api/courses/:courseId/tests
- Authentication: Yes
- Response (200): tests for user in course

POST /api/courses/:courseId/test/generate
- Authentication: Yes
- Request body: none
- Response (200): generated test payload and metadata

POST /api/courses/:courseId/test/submit
- Authentication: Yes
- Request body:
	```json
	{ "testId": "string", "answers": [ /* answers array */ ] }
	```
- Response (200): submission acknowledgement

GET /api/courses/:courseId/test/:testId/validate
- Authentication: Yes
- Response (200): validation result for accessing a test

GET /api/courses/:courseId/test/:testId/status
- Authentication: Yes
- Response (200): current status and evaluation results

GET /api/courses/:courseId/test/:testId/certificate
- Authentication: Yes
- Response (200): certificate data when test completed and passed

GET /api/courses/verify-certificate/:certificateId
- Authentication: No
- Response (200): verification result
	```json
	{ "success": true, "isValid": true, "certificateDetails": { /* certificate */ } }
	```

---

## Roadmaps (/api/roadmaps)

GET /api/roadmaps/
- Authentication: Optional
- Query: `search`, `filter` (`all|my-roadmaps|bookmarked`), `sort`, `page`, `limit`
- Response (200): list with pagination

GET /api/roadmaps/:id
- Authentication: Optional
- Response (200): roadmap details

POST /api/roadmaps/generate
- Authentication: Yes
- Request body:
	```json
	{ "topic": "string" }
	```
- Response (200): AI-generated roadmap JSON object

POST /api/roadmaps/
- Authentication: Yes
- Request body:
	```json
	{ "title": "string", "description": "string", "topic": "string", "content": { /* generated roadmap object */ }, "isPublic": true }
	```
- Response (201): roadmap created

POST /api/roadmaps/:id/bookmark
- Authentication: Yes
- Response (200): toggles bookmark

PUT /api/roadmaps/:id
- Authentication: Yes
- Request body: any of `title`, `description`, `topic`, `isPublic`
- Response (200): updated roadmap

DELETE /api/roadmaps/:id
- Authentication: Yes
- Response (200): deleted

---

## Discussions (/api/discussions)

GET /api/discussions/test
- Authentication: No
- Response (200): health check

GET /api/discussions/
- Authentication: No
- Query: `category`, `tag`, `search`, `sort`, `page`, `limit`
- Response (200): list of discussions with pagination

GET /api/discussions/:id
- Authentication: No
- Response (200): discussion details with answers and replies

POST /api/discussions/
- Authentication: Yes
- Request body:
	```json
	{ "title": "string", "content": "string", "category": "string", "tags": ["string"], "images": ["url"] }
	```
- Response (201): created discussion id

POST /api/discussions/:id/answers
- Authentication: Yes
- Request body:
	```json
	{ "content": "string", "images": ["url"] }
	```
- Response (201): created answer id

POST /api/discussions/answers/:answerId/replies
- Authentication: Yes
- Request body:
	```json
	{ "content": "string", "images": ["url"] }
	```
- Response (201): created reply id

POST /api/discussions/:id/vote
- Authentication: Yes
- Request body:
	```json
	{ "voteType": "up|down" }
	```
- Response (200): updated vote counts

POST /api/discussions/answers/:answerId/vote
- Authentication: Yes
- Request body:
	```json
	{ "voteType": "up|down" }
	```

POST /api/discussions/replies/:replyId/vote
- Authentication: Yes
- Request body:
	```json
	{ "voteType": "up|down" }
	```

POST /api/discussions/answers/:answerId/best
- Authentication: Yes
- Response (200): marks an answer as best (only discussion author)

GET /api/notifications
- Authentication: Yes
- Query: `page`, `limit`
- Response (200): notifications list with pagination

PUT /api/notifications/:id/read
- Authentication: Yes
- Response (200): marks notification as read

GET /api/discussions/tags/popular
- Authentication: No
- Query: `limit`
- Response (200): array of popular tags

GET /api/discussions/users/search
- Authentication: Yes
- Query: `q` (search term)
- Response (200): list of usernames for mention autocomplete

---

## PDFs (/api/pdfs)

GET /api/pdfs/
- Authentication: No
- Query parameters:
	- `page`, `limit`, `search`, `semester`, `course`, `department`, `year_of_study`, `sortBy`, `sortOrder`
- Response (200): list of PDFs, filters and pagination
	```json
	{ "pdfs": [ /* pdf objects */ ], "filters": { "availableCourses": [], "availableDepartments": [] }, "pagination": { /* ... */ } }
	```

POST /api/pdfs/generate-upload-url
- Authentication: Yes (admin)
- Request body:
	```json
	{ "filename": "string", "contentType": "application/pdf" }
	```
- Response (200):
	```json
	{ "url": "https://...", "pathname": "/pdfs/123-filename.pdf" }
	```

POST /api/pdfs/store-metadata
- Authentication: Yes (admin)
- Request body:
	```json
	{ "title": "string", "description": "string", "semester": "string", "course": "string", "department": "string", "year_of_study": "string", "blob_url": "string" }
	```
- Response (201):
	```json
	{ "id": "string", "message": "PDF metadata stored successfully" }
	```

---

## E-books (/api/ebooks)

GET /api/ebooks/
- Authentication: No
- Query parameters: same as `/api/pdfs`
- Response (200): list of e-books, filters and pagination

POST /api/ebooks/generate-upload-url
- Authentication: Yes (admin)
- Request body:
	```json
	{ "filename": "string", "contentType": "application/pdf" }
	```
- Response (200): upload URL and pathname

POST /api/ebooks/store-metadata
- Authentication: Yes (admin)
- Request body:
	```json
	{ "title": "string", "description": "string", "semester": "string", "course": "string", "department": "string", "year_of_study": "string", "blob_url": "string" }
	```
- Response (201):
	```json
	{ "id": "string", "message": "E-book metadata stored successfully" }
	```

---

Notes
- All endpoints that require authentication expect an `Authorization: Bearer <token>` header.
- Error responses use standard HTTP status codes and return JSON with an `error` or `message` field.
- For endpoints that accept arrays (e.g., `chapters`, `tags`, `images`), supply JSON arrays.



